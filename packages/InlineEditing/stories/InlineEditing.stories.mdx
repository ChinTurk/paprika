import { Meta } from "@storybook/addon-docs/blocks";
import Blocks, { Block } from "storybook/components/Blocks";
import { getStoryName } from "storybook/storyTree";
import { AppInlineInput } from "./examples/InlineInput.simple.js";
import TextAreaStory from "./examples/Textarea.js";
import InputStory from "./examples/Input.js";
import { ListBoxSingleStory, ListBoxMultipleStory } from "./examples/ListBox.js";

export const params = {
  options: {
    isToolshown: true,
    showPanel: false,
  },
};

<Meta title={`${getStoryName("InlineEditing")}/Docs`} parameters={params} />

# Inline Editing

The `<InlineEditing />` component allows you to display two values for the user one when the componet is not in editing mode and an input whenever the user interact and set
the component into editing mode.

## How does it works?

The InlineEditing package includes a component name `<Editor />` that you can use to encapsulated this kind of interaction. The `<Editor />` Component comes with two
subcomponent `<Editor.Value />` and `<Editor.Edit />`. This two component will switch between each other whenever the prop `isEditing` on the `Editor` component chages.

The following is an example of usign the Editor component to build a simple Text (value) `->` Text (input) interaction:

<Blocks>
  <Block>
    <AppInlineInput />
  </Block>
  <Block>

```jsx
function InlineInput(props) {
  const { value, onSubmit, isEditing, onClick } = props;
  const refInput = React.useRef(null);

  function handleClick() {
    onClick();
  }

  function submit() {
    onSubmit({ nextValue: refInput.current.value });
  }

  return (
    <Editor onEdit={() => {}} isEditing={isEditing} onClick={handleClick}>
      <Editor.Edit>
        {/** we are going to only report back when the user hits Enter */}
        <Input
          defaultValue={value}
          type="text"
          ref={refInput}
          onKeyUp={event => {
            if (event.key === "Enter") {
              submit();
            }
          }}
        />
      </Editor.Edit>
      <Editor.Value>
        <span style={{ textDecoration: "underline" }}>{value}</span>
      </Editor.Value>
    </Editor>
  );
}

export function App() {
  const [value, setValue] = React.useState("Click on it to edit it");
  const [isEditing, setIsEditing] = React.useState(false);

  function handleClick() {
    setIsEditing(true);
  }

  function handleSubmit({ nextValue }) {
    setValue(nextValue);
    setIsEditing(false);
  }

  // prettier-ignore
  return (
    <InlineInput 
      value={value} 
      onClick={handleClick} 
      isEditing={isEditing} 
      onSubmit={handleSubmit} 
    />
  )
}
```

  </Block>
</Blocks>

The previous example is a simple attempt to create a InlineEditng Input, to have it fully functionable will still required more work with the keyboard interactions,
add focus onClick, cancel it onKeyUp === "Escape", etc.

An because wiring a fully functionally InlineEditing component can be tedious and tricky to make it work properly, we currently are providing three components ready to use:

- Input type text
- TextArea
- ListBox

## Available InlineEditing Components

### Input

<Blocks>
  <Block>
    <InputStory />
  </Block>
  <Block>

```jsx
import Input from "@paprika/inline-editing/lib/Input";

const [isEditing, setIsEditing] = React.useState(false);

<Textarea
  value="your value"
  onSubmit={handleSubmit}
  onEditingClose={() => setIsEditing(false)}
  onEditingOpen={() => setIsEditing(true)}
  isEditing={isEditing}
/>;
```

  </Block>
</Blocks>

### TextArea

<Blocks>
  <Block>
    <TextAreaStory />
  </Block>
  <Block>

```jsx
import TextArea from "@paprika/inline-editing/lib/Textarea";

const [isEditing, setIsEditing] = React.useState(false);

<Textarea
  value="your value"
  onSubmit={handleSubmit}
  onEditingClose={() => setIsEditing(false)}
  onEditingOpen={() => setIsEditing(true)}
  isEditing={isEditing}
/>;
```

  </Block>
</Blocks>

### ListBox

<Blocks>
  <Block>
    <ListBoxSingleStory />
    <div style={{ width: "100%", height: "44px" }}></div>
    <ListBoxMultipleStory />
  </Block>
  <Block>

```jsx
import ListBox from "@paprika/inline-editing/lib/ListBox";

const [isEditing, setIsEditing] = React.useState(false);

<ListBox
  isEditing={isEditing}
  onChange={() => {}}
  onClose={() => {}}
  onEditing={() => {}}
  onSubmit={handleSubmit}
  value={value}
>
  {subscriptionTypes.map(subscription => (
    <ListBox.Option value={subscription} isSelected={subscription === value} key={subscription}>
      {subscription}
    </ListBox.Option>
  ))}
</ListBox>;
```

  </Block>
</Blocks>
